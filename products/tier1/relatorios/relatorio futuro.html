<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Warehouse: RelatÃ³rio EstratÃ©gico para Stakeholders</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            border-bottom: 4px solid #2c3e50;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            font-weight: 300;
        }
        
        .header .date {
            color: #95a5a6;
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .executive-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 40px;
        }
        
        .executive-summary h2 {
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .executive-summary ul {
            list-style: none;
            padding-left: 0;
        }
        
        .executive-summary li {
            margin: 10px 0;
            padding-left: 25px;
            position: relative;
        }
        
        .executive-summary li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        h3 {
            color: #34495e;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        h4 {
            color: #555;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        p {
            margin: 15px 0;
            text-align: justify;
        }
        
        .highlight-box {
            background: #ecf0f1;
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .problem-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .solution-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .cost-box {
            background: #e7f3ff;
            border: 2px solid #0066cc;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        
        table th {
            background: #34495e;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        
        table tr:hover {
            background: #f5f5f5;
        }
        
        .comparison-table {
            margin: 30px 0;
        }
        
        .comparison-table th {
            background: #2c3e50;
        }
        
        .architecture-diagram {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            text-align: center;
            overflow-x: auto;
        }
        
        .roi-section {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .roi-section h3 {
            color: white;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        
        .metric-card {
            background: white;
            color: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .metric-card h4 {
            color: #27ae60;
            margin-bottom: 10px;
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #27ae60;
            margin: 10px 0;
        }
        
        .phase-box {
            border: 2px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .phase-box h4 {
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            text-align: center;
            color: #7f8c8d;
        }
        
        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š Data Warehouse</h1>
            <div class="subtitle">RelatÃ³rio EstratÃ©gico de ImplementaÃ§Ã£o</div>
            <div class="date">Data Warehouse: A PeÃ§a que Faltava na UnificaÃ§Ã£o de Sistemas</div>
        </div>

        <div class="executive-summary">
            <h2>ğŸ“‹ Resumo Executivo</h2>
            <ul>
                <li><strong>Problema:</strong> Dados de negÃ³cio espalhados em mÃºltiplos sistemas, dificultando anÃ¡lise e tomada de decisÃ£o</li>
                <li><strong>SoluÃ§Ã£o:</strong> Data Warehouse centralizado para unificar dados de todos os produtos e sistemas</li>
                <li><strong>Complementa:</strong> EstratÃ©gia CIAM (Okta) - enquanto CIAM resolve "quem acessa", DW resolve "o que aconteceu"</li>
                <li><strong>Investimento:</strong> $10-30/mÃªs (PostgreSQL no Render) ou FREE no inÃ­cio</li>
                <li><strong>ROI:</strong> Economiza 10-20 horas/mÃªs em relatÃ³rios manuais = $500-1000/mÃªs em tempo de equipe</li>
                <li><strong>RecomendaÃ§Ã£o:</strong> Implementar em paralelo com CIAM, comeÃ§ando com PostgreSQL bÃ¡sico no Render</li>
            </ul>
        </div>

        <h2>1. O Problema: Por Que Precisamos de Data Warehouse?</h2>
        
        <div class="problem-box">
            <h3>ğŸ”´ SituaÃ§Ã£o Atual: Dados Espalhados</h3>
            <p>Mesmo apÃ³s implementar o CIAM (Okta) para unificar identidades, nossos <strong>dados de negÃ³cio continuam fragmentados</strong>:</p>
            <ul>
                <li><strong>SaaS de AnÃ¡lise:</strong> Dados de uso (queries, relatÃ³rios) no PostgreSQL Render</li>
                <li><strong>Faturamento:</strong> Dados de pagamento no Stripe/Asaas (API externa)</li>
                <li><strong>CRM:</strong> Dados de vendas e leads no HubSpot/Pipedrive (sistema separado)</li>
                <li><strong>Bot Telegram:</strong> Dados de interaÃ§Ã£o em SQLite ou PostgreSQL isolado</li>
                <li><strong>Google Analytics:</strong> Dados de web traffic (outro sistema isolado)</li>
            </ul>
        </div>

        <h3>1.1. O Que Isso Significa na PrÃ¡tica?</h3>
        
        <p>Quando um stakeholder precisa responder perguntas crÃ­ticas do negÃ³cio, a equipe enfrenta:</p>
        
        <table class="comparison-table">
            <tr>
                <th>Pergunta do NegÃ³cio</th>
                <th>Sem Data Warehouse</th>
                <th>Com Data Warehouse</th>
            </tr>
            <tr>
                <td>"Qual produto gera mais receita?"</td>
                <td>âš ï¸ Acessar Stripe, verificar cada produto, somar manualmente</td>
                <td>âœ… Query SQL: <code>SELECT product, SUM(amount) FROM dw_billing</code></td>
            </tr>
            <tr>
                <td>"Quem sÃ£o nossos clientes mais valiosos?"</td>
                <td>âš ï¸ Extrair do CRM, cruzar com faturamento, calcular em Excel</td>
                <td>âœ… Query SQL pronta em segundos</td>
            </tr>
            <tr>
                <td>"Qual a taxa de churn por produto?"</td>
                <td>âš ï¸ DifÃ­cil, requer cruzamento manual de mÃºltiplas fontes</td>
                <td>âœ… AnÃ¡lise automÃ¡tica com query Ãºnica</td>
            </tr>
            <tr>
                <td>"Quantos usuÃ¡rios ativos temos esta semana?"</td>
                <td>âš ï¸ Verificar cada sistema separadamente, somar manualmente</td>
                <td>âœ… Dashboard atualizado automaticamente</td>
            </tr>
        </table>

        <div class="highlight-box">
            <strong>ğŸ’¡ Impacto Real:</strong> Estimamos que a equipe de gestÃ£o gasta <strong>10-20 horas por mÃªs</strong> apenas coletando e consolidando dados manualmente para relatÃ³rios. Esse tempo poderia ser dedicado a estratÃ©gia e crescimento, nÃ£o a extraÃ§Ã£o de dados.
        </div>

        <h2>2. O Que Ã‰ Data Warehouse (De Forma Simples)?</h2>
        
        <h3>2.1. A MetÃ¡fora da Biblioteca Central</h3>
        
        <p>Imagine que cada sistema da empresa Ã© uma biblioteca diferente:</p>
        
        <ul>
            <li><strong>Biblioteca A (SaaS AnÃ¡lise):</strong> Tem livros sobre uso de produtos</li>
            <li><strong>Biblioteca B (Faturamento):</strong> Tem livros sobre pagamentos</li>
            <li><strong>Biblioteca C (CRM):</strong> Tem livros sobre vendas</li>
            <li><strong>Biblioteca D (Bot Telegram):</strong> Tem livros sobre interaÃ§Ãµes</li>
        </ul>
        
        <p><strong>Data Warehouse Ã© a Biblioteca Central:</strong></p>
        <ul>
            <li>âœ… Todos os livros (dados) estÃ£o no mesmo lugar</li>
            <li>âœ… Mesmo sistema de classificaÃ§Ã£o (schema unificado)</li>
            <li>âœ… Acesso rÃ¡pido para qualquer anÃ¡lise</li>
            <li>âœ… NÃ£o precisa visitar 5 bibliotecas diferentes</li>
        </ul>

        <h3>2.2. DefiniÃ§Ã£o TÃ©cnica (Simplificada)</h3>
        
        <p><strong>Data Warehouse (DW)</strong> Ã© um banco de dados especializado em armazenar e organizar dados histÃ³ricos de mÃºltiplas fontes, formatado especificamente para anÃ¡lises e relatÃ³rios de negÃ³cio (Business Intelligence - BI).</p>
        
        <div class="solution-box">
            <p><strong>ğŸ”‘ CaracterÃ­sticas Principais:</strong></p>
            <ul>
                <li><strong>Centralizado:</strong> Todos os dados importantes em um Ãºnico lugar</li>
                <li><strong>Organizado:</strong> Estrutura pensada para anÃ¡lises rÃ¡pidas</li>
                <li><strong>HistÃ³rico:</strong> MantÃ©m histÃ³rico completo de mudanÃ§as</li>
                <li><strong>RÃ¡pido:</strong> Otimizado para queries complexas e relatÃ³rios</li>
            </ul>
        </div>

        <h2>3. Por Que CIAM NÃ£o Resolve Isso?</h2>
        
        <h3>3.1. CIAM vs. Data Warehouse: FunÃ§Ãµes Diferentes</h3>
        
        <table class="comparison-table">
            <tr>
                <th>Aspecto</th>
                <th>CIAM (Okta)</th>
                <th>Data Warehouse</th>
            </tr>
            <tr>
                <td><strong>FunÃ§Ã£o Principal</strong></td>
                <td>AutenticaÃ§Ã£o e autorizaÃ§Ã£o</td>
                <td>AnÃ¡lise e Business Intelligence</td>
            </tr>
            <tr>
                <td><strong>Foco</strong></td>
                <td>"Quem pode acessar?"</td>
                <td>"O que aconteceu?"</td>
            </tr>
            <tr>
                <td><strong>Tipo de Dados</strong></td>
                <td>Identidade do usuÃ¡rio (login, senha, permissÃµes)</td>
                <td>Comportamento, vendas, uso, mÃ©tricas de negÃ³cio</td>
            </tr>
            <tr>
                <td><strong>Pergunta Que Responde</strong></td>
                <td>"Este usuÃ¡rio pode acessar o produto X?"</td>
                <td>"Qual produto gera mais receita este mÃªs?"</td>
            </tr>
            <tr>
                <td><strong>Quando Ã‰ Usado</strong></td>
                <td>Tempo real (toda vez que alguÃ©m faz login)</td>
                <td>AnÃ¡lises e relatÃ³rios (quando gestÃ£o precisa de insights)</td>
            </tr>
        </table>

        <h3>3.2. Como Eles Se Complementam</h3>
        
        <div class="architecture-diagram">
            <pre>
FLUXO COMPLETO: CIAM + DATA WAREHOUSE

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CLIENTE / COLABORADOR           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     CIAM (Okta) - "Quem pode acessar"   â”‚
â”‚   âœ… Single Sign-On                     â”‚
â”‚   âœ… AutenticaÃ§Ã£o unificada             â”‚
â”‚   âœ… Gerenciamento de identidades        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼ Autentica e autoriza acesso
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      PRODUTOS (SaaS, Bots, etc.)        â”‚
â”‚   â€¢ SaaS de AnÃ¡lise JurÃ­dica           â”‚
â”‚   â€¢ Bot Telegram                        â”‚
â”‚   â€¢ Futuros produtos/Bots              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼ Dados de uso e comportamento sÃ£o gerados
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DATA WAREHOUSE - "O que aconteceu"  â”‚
â”‚   ğŸ“Š AnÃ¡lise unificada                  â”‚
â”‚   ğŸ“ˆ Business Intelligence              â”‚
â”‚   ğŸ¯ MÃ©tricas de negÃ³cio                â”‚
â”‚   ğŸ’° AnÃ¡lise de receita                 â”‚
â”‚   ğŸ‘¥ AnÃ¡lise de comportamento           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </pre>
        </div>

        <div class="highlight-box">
            <strong>ğŸ¯ ConclusÃ£o:</strong> CIAM e Data Warehouse sÃ£o <strong>complementares, nÃ£o concorrentes</strong>. CIAM resolve acesso, DW resolve anÃ¡lise. Precisamos de ambos para uma plataforma verdadeiramente unificada.
        </div>

        <h2>4. Arquitetura: Como Funciona na PrÃ¡tica?</h2>
        
        <h3>4.1. O Processo ETL (Extract, Transform, Load)</h3>
        
        <p>O Data Warehouse funciona atravÃ©s de um processo chamado <strong>ETL</strong> (Extract, Transform, Load):</p>
        
        <h4>ğŸ”¹ ETAPA 1: EXTRACT (Extrair)</h4>
        <p>Coletamos dados de todos os sistemas fonte:</p>
        <ul>
            <li>SaaS de AnÃ¡lise â†’ PostgreSQL no Render</li>
            <li>Faturamento â†’ Stripe API / Asaas API</li>
            <li>CRM â†’ HubSpot API / Pipedrive API</li>
            <li>Bot Telegram â†’ SQLite ou PostgreSQL</li>
            <li>Google Analytics â†’ Google Analytics API</li>
        </ul>
        
        <h4>ğŸ”¹ ETAPA 2: TRANSFORM (Transformar)</h4>
        <p>Normalizamos e limpamos os dados para um formato unificado:</p>
        <ul>
            <li>Unificar formato de datas</li>
            <li>Padronizar nomes de produtos</li>
            <li>Vincular usuÃ¡rios pelo ID do CIAM (Okta)</li>
            <li>Remover duplicatas</li>
            <li>Validar integridade dos dados</li>
        </ul>
        
        <h4>ğŸ”¹ ETAPA 3: LOAD (Carregar)</h4>
        <p>Inserimos os dados limpos no Data Warehouse</p>
        
        <div class="code-block">
# Exemplo de processo ETL (simplificado)
1. EXTRAIR: SELECT * FROM user_activity WHERE created_at > yesterday
2. TRANSFORMAR: Converter formato, vincular user_id do Okta
3. CARREGAR: INSERT INTO dw_events (user_id, event_type, ...)
        </div>

        <h3>4.2. OpÃ§Ãµes de ImplementaÃ§Ã£o</h3>
        
        <table class="comparison-table">
            <tr>
                <th>OpÃ§Ã£o</th>
                <th>Quando Usar</th>
                <th>PrÃ³s</th>
                <th>Contras</th>
                <th>Custo Estimado</th>
            </tr>
            <tr>
                <td><strong>PostgreSQL no Render</strong></td>
                <td>InÃ­cio e atÃ© ~100K eventos/mÃªs</td>
                <td>âœ… JÃ¡ conhecemos<br>âœ… Sem custo adicional<br>âœ… FÃ¡cil integraÃ§Ã£o</td>
                <td>âš ï¸ Pode ficar lento com muito volume</td>
                <td>$10-30/mÃªs ou FREE</td>
            </tr>
            <tr>
                <td><strong>BigQuery (Google)</strong></td>
                <td>Crescimento (>1M eventos/mÃªs)</td>
                <td>âœ… Escala ilimitada<br>âœ… Muito rÃ¡pido<br>âœ… Pay-per-use</td>
                <td>âš ï¸ Requer conta Google Cloud<br>âš ï¸ Curva de aprendizado</td>
                <td>~$5/TB processado</td>
            </tr>
            <tr>
                <td><strong>Snowflake</strong></td>
                <td>Empresa grande, volumes massivos</td>
                <td>âœ… Performance excelente<br>âœ… Muito flexÃ­vel</td>
                <td>âš ï¸ Mais caro<br>âš ï¸ Mais complexo</td>
                <td>$2-4/credit (variÃ¡vel)</td>
            </tr>
        </table>

        <div class="solution-box">
            <p><strong>ğŸ¯ RecomendaÃ§Ã£o para Nossa SituaÃ§Ã£o:</strong></p>
            <p><strong>FASE 1 (Agora):</strong> PostgreSQL no Render (simples, familiar, barato)</p>
            <p><strong>FASE 2 (Futuro):</strong> Migrar para BigQuery quando volume crescer e precisarmos de anÃ¡lises mais complexas</p>
        </div>

        <h2>5. ImplementaÃ§Ã£o PrÃ¡tica: Estrutura do Data Warehouse</h2>
        
        <h3>5.1. Tabelas Principais (Schema BÃ¡sico)</h3>
        
        <h4>ğŸ“Š Tabela: dw_events (Eventos do NegÃ³cio)</h4>
        <p>Armazena todos os eventos importantes que acontecem nos produtos:</p>
        
        <div class="code-block">
dw_events:
â”œâ”€â”€ id (Ãºnico identificador)
â”œâ”€â”€ user_id (vinculado ao CIAM - Okta)
â”œâ”€â”€ event_type ('purchase', 'usage', 'login', 'signup', etc.)
â”œâ”€â”€ product ('saas_analise', 'bot_telegram', etc.)
â”œâ”€â”€ timestamp (quando aconteceu)
â”œâ”€â”€ metadata (dados adicionais em JSON)
â””â”€â”€ source_system ('stripe', 'crm', 'bot', etc.)
        </div>
        
        <h4>ğŸ’° Tabela: dw_billing (Faturamento Consolidado)</h4>
        <p>Centraliza todos os dados de receita:</p>
        
        <div class="code-block">
dw_billing:
â”œâ”€â”€ id
â”œâ”€â”€ user_id (vinculado ao CIAM)
â”œâ”€â”€ invoice_date (data do pagamento)
â”œâ”€â”€ amount (valor em R$)
â”œâ”€â”€ product (qual produto foi pago)
â”œâ”€â”€ status ('paid', 'pending', 'canceled')
â””â”€â”€ source ('stripe', 'asaas', etc.)
        </div>
        
        <h4>ğŸ“ˆ Tabela: dw_usage (Uso de Produtos)</h4>
        <p>MÃ©tricas de uso de cada produto:</p>
        
        <div class="code-block">
dw_usage:
â”œâ”€â”€ id
â”œâ”€â”€ user_id (vinculado ao CIAM)
â”œâ”€â”€ product ('saas_analise', 'bot_telegram')
â”œâ”€â”€ event_date (data do uso)
â”œâ”€â”€ metric_name ('queries_run', 'bots_messages', etc.)
â””â”€â”€ metric_value (quantidade/nÃºmero)
        </div>

        <h3>5.2. Processo ETL Automatizado</h3>
        
        <p>O processo ETL roda automaticamente (a cada hora ou diariamente) para manter os dados atualizados:</p>
        
        <div class="phase-box">
            <h4>ğŸ”„ Fluxo AutomÃ¡tico ETL</h4>
            <ol>
                <li><strong>EXTRAIR (Extract):</strong> Script Python consulta cada sistema fonte</li>
                <li><strong>TRANSFORMAR (Transform):</strong> Normaliza dados e vincula ao user_id do CIAM</li>
                <li><strong>CARREGAR (Load):</strong> Insere dados limpos no Data Warehouse</li>
                <li><strong>AGENDAMENTO:</strong> Render Cron Job ou GitHub Actions roda esse processo periodicamente</li>
            </ol>
        </div>

        <h3>5.3. Queries Ãšteis para GestÃ£o</h3>
        
        <p>Com os dados unificados, podemos responder perguntas complexas com queries simples:</p>
        
        <div class="code-block">
-- Receita por produto (Ãºltimos 30 dias)
SELECT 
    product,
    SUM(amount) as revenue,
    COUNT(DISTINCT user_id) as customers
FROM dw_billing
WHERE invoice_date >= CURRENT_DATE - INTERVAL '30 days'
  AND status = 'paid'
GROUP BY product;

-- UsuÃ¡rios mais ativos (Top 10)
SELECT 
    user_id,
    product,
    COUNT(*) as events,
    MAX(timestamp) as last_activity
FROM dw_events
WHERE timestamp >= CURRENT_DATE - INTERVAL '7 days'
GROUP BY user_id, product
ORDER BY events DESC
LIMIT 10;

-- Taxa de conversÃ£o (signup â†’ pagamento)
WITH signups AS (
    SELECT COUNT(DISTINCT user_id) as total_signups
    FROM dw_events
    WHERE event_type = 'signup'
      AND timestamp >= CURRENT_DATE - INTERVAL '30 days'
),
paid AS (
    SELECT COUNT(DISTINCT user_id) as total_paid
    FROM dw_billing
    WHERE invoice_date >= CURRENT_DATE - INTERVAL '30 days'
      AND status = 'paid'
)
SELECT 
    signups.total_signups,
    paid.total_paid,
    ROUND((paid.total_paid::DECIMAL / signups.total_signups * 100), 2) as conversion_rate
FROM signups, paid;
        </div>

        <h2>6. AnÃ¡lise de Custos Detalhada</h2>
        
        <div class="cost-box">
            <h3>ğŸ’µ Investimento NecessÃ¡rio</h3>
            
            <h4>OpÃ§Ã£o Recomendada: PostgreSQL no Render</h4>
            
            <table>
                <tr>
                    <th>Item</th>
                    <th>Custo Mensal</th>
                    <th>Detalhamento</th>
                </tr>
                <tr>
                    <td>Banco PostgreSQL (Render Starter)</td>
                    <td>$7-15</td>
                    <td>Plano bÃ¡sico suficiente para inÃ­cio</td>
                </tr>
                <tr>
                    <td>Banco PostgreSQL (Render Standard)</td>
                    <td>$25-50</td>
                    <td>Se precisar de mais performance</td>
                </tr>
                <tr>
                    <td>Processamento ETL</td>
                    <td>$0</td>
                    <td>Rodando no mesmo plano Render existente</td>
                </tr>
                <tr>
                    <td>Armazenamento</td>
                    <td>IncluÃ­do</td>
                    <td>AtÃ© certo limite no plano Render</td>
                </tr>
            </table>
            
            <div class="metric-card">
                <h4>Custo Total Estimado (Fase Inicial)</h4>
                <div class="metric-value">$10 - $30/mÃªs</div>
                <p>Ou <strong>GRATUITO</strong> se aproveitar recursos jÃ¡ existentes</p>
            </div>
        </div>

        <h3>6.1. Custo de Oportunidade (O Que Perdemos SEM Data Warehouse)</h3>
        
        <table class="comparison-table">
            <tr>
                <th>Atividade</th>
                <th>Tempo Gasto/mÃªs</th>
                <th>Custo Estimado*</th>
            </tr>
            <tr>
                <td>Coleta manual de dados de mÃºltiplos sistemas</td>
                <td>4-6 horas</td>
                <td>$200-400</td>
            </tr>
            <tr>
                <td>ConsolidaÃ§Ã£o em planilhas (Excel/Sheets)</td>
                <td>3-5 horas</td>
                <td>$150-300</td>
            </tr>
            <tr>
                <td>GeraÃ§Ã£o de relatÃ³rios manuais</td>
                <td>3-4 horas</td>
                <td>$150-250</td>
            </tr>
            <tr>
                <td>CorreÃ§Ã£o de erros de dados</td>
                <td>2-3 horas</td>
                <td>$100-200</td>
            </tr>
            <tr>
                <td><strong>TOTAL</strong></td>
                <td><strong>12-18 horas/mÃªs</strong></td>
                <td><strong>$600-1150/mÃªs</strong></td>
            </tr>
        </table>
        
        <p style="font-size: 0.9em; color: #7f8c8d;">*Baseado em salÃ¡rio mÃ©dio de analista/gestor de $50-60/hora</p>

        <div class="roi-section">
            <h3>ğŸ“Š ROI (Retorno Sobre Investimento)</h3>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px;">
                <div class="metric-card">
                    <h4>Investimento</h4>
                    <div class="metric-value" style="color: #3498db;">$30/mÃªs</div>
                    <p>Custo do Data Warehouse</p>
                </div>
                
                <div class="metric-card">
                    <h4>Economia</h4>
                    <div class="metric-value" style="color: #27ae60;">$600-1150/mÃªs</div>
                    <p>Tempo economizado em relatÃ³rios</p>
                </div>
            </div>
            
            <div class="metric-card" style="margin-top: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h4 style="color: white;">ROI Estimado</h4>
                <div class="metric-value" style="color: white; font-size: 2.5em;">2000% - 3800%</div>
                <p style="color: rgba(255,255,255,0.9);">Retorno anual sobre investimento</p>
            </div>
        </div>

        <h2>7. BenefÃ­cios MensurÃ¡veis</h2>
        
        <h3>7.1. BenefÃ­cios Imediatos</h3>
        
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 20px 0;">
            <div class="metric-card">
                <h4>â±ï¸ Tempo Economizado</h4>
                <div class="metric-value" style="color: #e74c3c;">12-18h/mÃªs</div>
                <p>Equipe de gestÃ£o nÃ£o precisa mais coletar dados manualmente</p>
            </div>
            
            <div class="metric-card">
                <h4>ğŸ“Š PrecisÃ£o dos Dados</h4>
                <div class="metric-value" style="color: #27ae60;">+95%</div>
                <p>ReduÃ§Ã£o de erros de digitaÃ§Ã£o e inconsistÃªncias</p>
            </div>
            
            <div class="metric-card">
                <h4>âš¡ Velocidade de AnÃ¡lise</h4>
                <div class="metric-value" style="color: #3498db;">10x mais rÃ¡pido</div>
                <p>Queries SQL vs. processo manual</p>
            </div>
            
            <div class="metric-card">
                <h4>ğŸ’¡ DecisÃµes Mais RÃ¡pidas</h4>
                <div class="metric-value" style="color: #f39c12;">Reais em tempo real</div>
                <p>Acesso imediato a mÃ©tricas crÃ­ticas do negÃ³cio</p>
            </div>
        </div>

        <h3>7.2. BenefÃ­cios EstratÃ©gicos</h3>
        
        <table class="comparison-table">
            <tr>
                <th>BenefÃ­cio</th>
                <th>Impacto no NegÃ³cio</th>
                <th>MÃ©trica Esperada</th>
            </tr>
            <tr>
                <td><strong>VisÃ£o Unificada</strong></td>
                <td>Stakeholders tÃªm acesso direto a dados consolidados</td>
                <td>ReduÃ§Ã£o de 80% em pedidos de relatÃ³rios</td>
            </tr>
            <tr>
                <td><strong>IdentificaÃ§Ã£o de Oportunidades</strong></td>
                <td>Detectar padrÃµes e tendÃªncias rapidamente</td>
                <td>Insights que levavam semanas, agora em horas</td>
            </tr>
            <tr>
                <td><strong>AutomaÃ§Ã£o de RelatÃ³rios</strong></td>
                <td>RelatÃ³rios gerados automaticamente (diÃ¡rio/semanal)</td>
                <td>100% de automaÃ§Ã£o vs. 0% hoje</td>
            </tr>
            <tr>
                <td><strong>Escalabilidade</strong></td>
                <td>Novos produtos nÃ£o requerem novos processos de relatÃ³rio</td>
                <td>Time-to-market de relatÃ³rios reduzido de semanas para dias</td>
            </tr>
        </table>

        <h2>8. Plano de ImplementaÃ§Ã£o em Fases</h2>
        
        <div class="phase-box">
            <h4>ğŸš€ FASE 1: MVP (Minimum Viable Product) - Semana 1-2</h4>
            <p><strong>Objetivo:</strong> Provar o conceito com dados bÃ¡sicos</p>
            <ul>
                <li>âœ… Criar PostgreSQL no Render (Data Warehouse bÃ¡sico)</li>
                <li>âœ… Criar estrutura de tabelas (dw_events, dw_billing, dw_usage)</li>
                <li>âœ… Integrar 2-3 fontes principais:
                    <ul>
                        <li>SaaS de AnÃ¡lise (PostgreSQL existente)</li>
                        <li>Faturamento (Stripe/Asaas API)</li>
                    </ul>
                </li>
                <li>âœ… Criar script ETL bÃ¡sico (Python)</li>
                <li>âœ… Agendar execuÃ§Ã£o automÃ¡tica (Render Cron)</li>
            </ul>
            <p><strong>Resultado:</strong> Primeiras queries unificadas funcionando</p>
        </div>
        
        <div class="phase-box">
            <h4>ğŸ“ˆ FASE 2: ExpansÃ£o - Semana 3-4</h4>
            <p><strong>Objetivo:</strong> Adicionar mais fontes e refinamento</p>
            <ul>
                <li>âœ… Integrar CRM (HubSpot/Pipedrive API)</li>
                <li>âœ… Integrar Bot Telegram (dados de interaÃ§Ã£o)</li>
                <li>âœ… Criar queries Ãºteis para gestÃ£o:
                    <ul>
                        <li>Receita por produto</li>
                        <li>UsuÃ¡rios mais ativos</li>
                        <li>Taxa de conversÃ£o</li>
                        <li>Churn rate</li>
                    </ul>
                </li>
                <li>âœ… Documentar queries comuns</li>
            </ul>
            <p><strong>Resultado:</strong> Data Warehouse completo operacional</p>
        </div>
        
        <div class="phase-box">
            <h4>ğŸ“Š FASE 3: Dashboards e AutomaÃ§Ã£o - Semana 5-6</h4>
            <p><strong>Objetivo:</strong> Facilitar uso para nÃ£o-tÃ©cnicos</p>
            <ul>
                <li>âœ… Criar dashboard simples (Metabase, Superset, ou customizado)</li>
                <li>âœ… Configurar relatÃ³rios automÃ¡ticos (email diÃ¡rio/semanal)</li>
                <li>âœ… Criar alertas (ex: queda brusca de receita)</li>
                <li>âœ… Treinar equipe de gestÃ£o no uso</li>
            </ul>
            <p><strong>Resultado:</strong> Stakeholders acessam dados sem depender de desenvolvedores</p>
        </div>
        
        <div class="phase-box">
            <h4>ğŸš€ FASE 4: OtimizaÃ§Ã£o e Escala - MÃªs 2+</h4>
            <p><strong>Objetivo:</strong> Preparar para crescimento</p>
            <ul>
                <li>âœ… Avaliar necessidade de migraÃ§Ã£o para BigQuery (se volume crescer)</li>
                <li>âœ… Otimizar queries lentas</li>
                <li>âœ… Adicionar novas mÃ©tricas conforme necessidade</li>
                <li>âœ… Integrar com sistemas de alerta e notificaÃ§Ã£o</li>
            </ul>
            <p><strong>Resultado:</strong> Data Warehouse escalÃ¡vel e otimizado</p>
        </div>

        <h2>9. IntegraÃ§Ã£o com EstratÃ©gia CIAM</h2>
        
        <h3>9.1. Trabalhando Juntos</h3>
        
        <p>Data Warehouse e CIAM sÃ£o <strong>complementares e devem ser implementados em paralelo</strong>:</p>
        
        <table class="comparison-table">
            <tr>
                <th>Fase CIAM</th>
                <th>Fase Data Warehouse</th>
                <th>Resultado Combinado</th>
            </tr>
            <tr>
                <td>Fase 1: PoC Okta</td>
                <td>Fase 1: MVP PostgreSQL</td>
                <td>Identidades unificadas + Dados comeÃ§ando a se unificar</td>
            </tr>
            <tr>
                <td>Fase 2: SSO Cliente</td>
                <td>Fase 2: ExpansÃ£o Fontes</td>
                <td>Cliente acessa tudo com 1 login + AnÃ¡lises completas disponÃ­veis</td>
            </tr>
            <tr>
                <td>Fase 3: IntegraÃ§Ã£o CRM</td>
                <td>Fase 3: Dashboards</td>
                <td>Dados fluem automaticamente + GestÃ£o visualiza tudo</td>
            </tr>
            <tr>
                <td>Fase 4: Novos Produtos</td>
                <td>Fase 4: OtimizaÃ§Ã£o</td>
                <td>Plataforma verdadeiramente unificada e escalÃ¡vel</td>
            </tr>
        </table>

        <div class="highlight-box">
            <strong>ğŸ¯ EstratÃ©gia Recomendada:</strong> ComeÃ§ar <strong>CIAM (Okta)</strong> e <strong>Data Warehouse (PostgreSQL)</strong> simultaneamente na Fase 1. Ambos sÃ£o independentes tecnicamente, mas se complementam estrategicamente para criar uma plataforma totalmente unificada.
        </div>

        <h2>10. Riscos e MitigaÃ§Ãµes</h2>
        
        <table class="comparison-table">
            <tr>
                <th>Risco</th>
                <th>Probabilidade</th>
                <th>Impacto</th>
                <th>MitigaÃ§Ã£o</th>
            </tr>
            <tr>
                <td>Custo maior que o esperado</td>
                <td>Baixa</td>
                <td>MÃ©dio</td>
                <td>ComeÃ§ar com PostgreSQL FREE/barato, migrar sÃ³ quando necessÃ¡rio</td>
            </tr>
            <tr>
                <td>Complexidade tÃ©cnica maior que o previsto</td>
                <td>MÃ©dia</td>
                <td>MÃ©dio</td>
                <td>Faseamento (comeÃ§ar simples, evoluir gradualmente)</td>
            </tr>
            <tr>
                <td>Dados inconsistentes entre sistemas</td>
                <td>Alta</td>
                <td>Alto</td>
                <td>Processo de transformaÃ§Ã£o (ETL) com validaÃ§Ãµes e limpeza</td>
            </tr>
            <tr>
                <td>Equipe nÃ£o adota/utiliza</td>
                <td>MÃ©dia</td>
                <td>Alto</td>
                <td>Dashboard intuitivo + Treinamento + DocumentaÃ§Ã£o clara</td>
            </tr>
        </table>

        <h2>11. ConclusÃ£o e PrÃ³ximos Passos</h2>
        
        <div class="executive-summary">
            <h3>ğŸ“‹ Resumo Executivo Final</h3>
            <ul>
                <li><strong>Data Warehouse</strong> Ã© a peÃ§a que faltava para complementar o CIAM na unificaÃ§Ã£o completa</li>
                <li><strong>Investimento inicial:</strong> MÃ­nimo ($10-30/mÃªs) ou FREE se usar recursos existentes</li>
                <li><strong>ROI:</strong> 2000-3800% ao ano (economiza 12-18h/mÃªs = $600-1150/mÃªs)</li>
                <li><strong>ImplementaÃ§Ã£o:</strong> 4-6 semanas em fases controladas</li>
                <li><strong>RecomendaÃ§Ã£o:</strong> Implementar em paralelo com CIAM, comeÃ§ando com PostgreSQL no Render</li>
            </ul>
        </div>

        <h3>ğŸš€ AÃ§Ã£o Imediata Recomendada</h3>
        
        <div class="phase-box">
            <h4>âœ… Aprovar ImplementaÃ§Ã£o SimultÃ¢nea:</h4>
            <ol>
                <li><strong>CIAM (Okta):</strong> Unificar identidades e acesso (jÃ¡ no relatÃ³rio anterior)</li>
                <li><strong>Data Warehouse:</strong> Unificar dados e anÃ¡lises (este relatÃ³rio)</li>
            </ol>
            
            <p style="margin-top: 20px;"><strong>Timeline Combinado:</strong></p>
            <ul>
                <li><strong>Semana 1-2:</strong> PoC Okta + MVP Data Warehouse</li>
                <li><strong>Semana 3-4:</strong> SSO Cliente + ExpansÃ£o DW</li>
                <li><strong>Semana 5-6:</strong> IntegraÃ§Ã£o completa + Dashboards</li>
            </ul>
            
            <p style="margin-top: 20px;"><strong>Investimento Total:</strong></p>
            <ul>
                <li>Okta CIAM: FREE (atÃ© 7.000 MAUs)</li>
                <li>Data Warehouse: $10-30/mÃªs (PostgreSQL Render)</li>
                <li><strong>TOTAL: $10-30/mÃªs</strong> (ou FREE no inÃ­cio)</li>
            </ul>
        </div>

        <div class="footer">
            <p><strong>Genesys Tecnologia</strong></p>
            <p>RelatÃ³rio EstratÃ©gico: Data Warehouse para UnificaÃ§Ã£o de Sistemas</p>
            <p>Data: <span id="current-date"></span></p>
        </div>
    </div>

    <script>
        // Adiciona data atual
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: 'long',
            year: 'numeric'
        });
    </script>
</body>
</html>